<template>
    <div class="aside-box" :style="changeAside">
        <div @click="goHome" @mousedown="clickLogoDown" @mouseup="clickLogoUp" @mouseleave="clickLogoUp">
            <Logo :collapse="isCollapse" :clickLogo="clickLogo"></Logo>
        </div>

        <div class="menu-box">
            <el-menu default-active="/project" router :collapse="isCollapse" @open="handleOpen" @close="handleClose">
                <el-sub-menu index="/project">
                    <template #title>
                        <el-icon>
                            <CopyDocument />
                        </el-icon>
                        <span>é¡¹ç›®ç®¡ç†</span>
                    </template>
                    <el-menu-item index="/project">ğŸ”… é¡¹ç›®æ±‡æ€»</el-menu-item>
                    <el-menu-item index="/project/list">ğŸ“¶ é¡¹ç›®åˆ—è¡¨</el-menu-item>
                    <el-menu-item index="/project/user">ğŸš» é¡¹ç›®äººå‘˜</el-menu-item>
                </el-sub-menu>
                <el-menu-item index="2">
                    <el-icon><icon-menu /></el-icon>
                    <template #title>Navigator Two</template>
                </el-menu-item>
                <el-menu-item index="3" disabled>
                    <el-icon>
                        <document />
                    </el-icon>
                    <template #title>Navigator Three</template>
                </el-menu-item>
                <el-menu-item index="4">
                    <el-icon>
                        <setting />
                    </el-icon>
                    <template #title>Navigator Four</template>
                </el-menu-item>
                <el-sub-menu index="/tool">
                    <template #title>
                        <el-icon>
                            <mouse />
                        </el-icon>
                        <span>å¼€å‘å·¥å…·</span>
                    </template>
                    <el-sub-menu index="/tool/code">
                        <template #title>ğŸ‘» å¿«é€Ÿä»£ç </template>
                        <el-menu-item index="/tool/code/javaauto">ğŸ¦´ Java auto</el-menu-item>
                        <el-menu-item index="/tool/code/vue3curd">ğŸ¤¢ Vue3 curd(TS)</el-menu-item>
                    </el-sub-menu>
                    <el-menu-item index="/tool/deploy">ğŸ¦´ éƒ¨ç½²</el-menu-item>
                    <el-menu-item index="/tool/role">ğŸ˜ å…¶ä»–</el-menu-item>
                </el-sub-menu>
                <el-sub-menu index="/ganqiguo">
                    <template #title>
                        <el-icon>
                            <cherry />
                        </el-icon>
                        <span>H5ç®¡ç†</span>
                    </template>
                    <el-menu-item index="/ganqiguo">ğŸµï¸ ç”˜å…¶æœ</el-menu-item>
                    <el-menu-item index="/ganqiguo/bonus">ğŸ‰ åˆ†çº¢ä¿¡æ¯</el-menu-item>
                    <el-menu-item index="/ganqiguo/pt">ğŸŠ å•†å“(ToB)</el-menu-item>
                    <el-menu-item index="/ganqiguo/gift">ğŸ ä¸“å±ç¤¼å“</el-menu-item>
                </el-sub-menu>
                <el-sub-menu index="/security">
                    <template #title>
                        <el-icon>
                            <key />
                        </el-icon>
                        <span>é¡¹ç›®ç®¡ç†</span>
                    </template>
                    <el-menu-item index="/security/authorization">ğŸ§± æˆæƒ</el-menu-item>
                    <el-menu-item index="/security/user">âš§ï¸ ç”¨æˆ·</el-menu-item>
                    <el-menu-item index="/security/role">ğŸ•µï¸ è§’è‰²</el-menu-item>
                    <el-menu-item index="/security/authority">ğŸ« æƒé™</el-menu-item>
                </el-sub-menu>
                <el-sub-menu index="/knowledge">
                    <template #title>
                        <el-icon>
                            <memo />
                        </el-icon>
                        <span>çŸ¥è¯†</span>
                    </template>
                    <el-menu-item index="/knowledge/java">â˜• Java</el-menu-item>
                    <el-menu-item index="/knowledge/cpp">ğŸ¾ C++</el-menu-item>
                </el-sub-menu>
                <el-sub-menu index="/my">
                    <template #title>
                        <el-icon>
                            <star />
                        </el-icon>
                        <span>æˆ‘çš„</span>
                    </template>
                    <el-menu-item index="/my/music">ğŸµ éŸ³ä¹</el-menu-item>
                </el-sub-menu>
                <el-sub-menu index="/square">
                    <template #title>
                        <el-icon>
                            <star />
                        </el-icon>
                        <span>å¹¿åœº</span>
                    </template>
                    <el-menu-item index="/square">ğŸš² éª‘è¡Œ</el-menu-item>
                </el-sub-menu>
            </el-menu>

            <el-menu default-active="1" class="menu-bottom" :collapse="isCollapse">
                <el-menu-item index="1" @click="isCollapse = !isCollapse">
                    <el-icon>
                        <DArrowRight v-if="isCollapse" />
                        <DArrowLeft v-if="!isCollapse" />
                    </el-icon>
                    <template #title v-if="isCollapse">æ‰“å¼€èœå•</template>
                    <template #title v-if="!isCollapse">æ”¶èµ·èœå•</template>
                </el-menu-item>

                <el-menu-item index="2" class="menu-avatar">
                    <el-avatar shape="square" :size="isCollapse ? 24 : 36" :src="avatar" fit="cover"
                        class="user-avatar" />

                    <template #title>
                        <div class="info-box">
                            <div class="info">
                                <div v-show="false">ID</div>
                                <div class="username">Tom</div>
                                <div class="userlevel">è¶…çº§ç®¡ç†å‘˜</div>
                            </div>

                            <div class="setting" @click="userSetting">
                                <el-icon>
                                    <Setting />
                                </el-icon>
                            </div>
                        </div>
                    </template>
                </el-menu-item>
            </el-menu>
        </div>

    </div>
</template>

<script lang="ts" setup>
import { onMounted, ref } from 'vue'
import Logo from './Logo.vue'
import {
    Document,
    Menu as IconMenu,
    Setting, DArrowRight, DArrowLeft, CopyDocument, Key, Mouse, Cherry, Star, Memo
} from '@element-plus/icons-vue'
import avatar from '../../assets/avatar.png'
import router from "@/router";

onMounted(() => {
    isHTML5()
})

const changeAside = ref('')
const isHTML5 = () => {
    if (!(window.history && history.pushState)) {
        changeAside.value = 'position: fixed;top: 93.4%'
    } else {
        changeAside.value = ''
    }
}

const goHome = () => { //è·³è½¬ä¸»é¡µ
    router.push("/")
}

const clickLogo = ref(false)
const clickLogoDown = () => {
    clickLogo.value = true
}
const clickLogoUp = () => {
    clickLogo.value = false
}

const isCollapse = ref(true)
const handleOpen = (key: string, keyPath: string[]) => {
    //æ‰“å¼€ä¾§è¾¹æ  è§¦å‘å‡½æ•°
}
const handleClose = (key: string, keyPath: string[]) => {
    //å…³é—­ä¾§è¾¹æ  è§¦å‘å‡½æ•°
}

const userSetting = () => {
    console.log('ç”¨æˆ·è®¾ç½®å‡½æ•°')
}
</script>

<style lang="scss" scoped>
@keyframes ball {
    0% {
        opacity: 1;
    }

    100% {
        opacity: 0;
    }
}

.aside-box {

    .menu-box {
        opacity: 1;

        .el-menu {
            border-right: none;
        }

        .menu-bottom {
            position: absolute;
            bottom: 8px;

            .menu-avatar {
                .user-avatar {
                    user-select: none;
                    pointer-events: none;
                    border: 1px solid #004d29;
                    cursor: pointer;
                }

                .info-box {
                    display: flex;

                    .info {
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                        margin-left: 8px;
                        cursor: default;

                        .username {
                            line-height: normal;
                        }

                        .userlevel {
                            line-height: normal;
                            font-size: 0.7rem;
                        }
                    }

                    .setting {
                        margin-left: 6px;
                    }
                }

            }
        }
    }

}
</style>